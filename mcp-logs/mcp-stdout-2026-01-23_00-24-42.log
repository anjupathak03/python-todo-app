{"jsonrpc":"2.0","id":1,"result":{"capabilities":{"logging":{},"tools":{"listChanged":true}},"instructions":"Keploy Mock MCP Server for recording and replaying outgoing calls from applications.\n\nAvailable tools:\n1. keploy_list_mocks - List all available recorded mock sets. Use this first to see what mocks exist.\n2. keploy_mock_record - Record outgoing calls (HTTP APIs, databases, etc.) from your application.\n3. keploy_mock_test - Replay recorded mocks during testing.\n\nWorkflow:\n- For recording: Ask user for the command to run their application, then use keploy_mock_record\n- For testing: First use keploy_list_mocks to show available mocks, then use keploy_mock_test\n\nImportant: Always confirm configuration with user before starting record/test operations.","protocolVersion":"2025-11-25","serverInfo":{"name":"keploy-mock","version":"v1.0.0"}}}
{"jsonrpc":"2.0","id":2,"result":{}}
{"jsonrpc":"2.0","id":3,"result":{"tools":[{"description":"List all available recorded mock sets in the keploy directory.\n\nUse this tool to:\n- Discover what mocks are available before running mock test\n- Show the user available options\n- Help user choose which mock set to use for testing\n\nReturns a list of mock set names/IDs that can be used with keploy_mock_test.","inputSchema":{"type":"object","properties":{"path":{"type":"string","description":"Path to search for mock files (default: ./keploy)"}},"additionalProperties":false},"name":"keploy_list_mocks","outputSchema":{"type":"object","required":["success","mockSets","count","path","message"],"properties":{"count":{"type":"integer"},"message":{"type":"string"},"mockSets":{"type":"array","items":{"type":"string"}},"path":{"type":"string"},"success":{"type":"boolean"}},"additionalProperties":false}},{"description":"Record outgoing calls (HTTP APIs, databases, message queues, etc.) made during command execution.\n\nThis tool captures all external dependencies while running the provided command, \ncreating mock files that can be replayed during testing.\n\nIMPORTANT: Before calling this tool, confirm the following with the user:\n- The command to run (typically the command to start your application, like 'go run main.go', 'npm start', './my-app', etc.)\n- The path to store mocks (default: ./keploy)\n\nThe tool will show the configuration and ask for confirmation before starting.\n\nParameters:\n- command (required): Any command to run (e.g., 'go run main.go', 'npm start', './my-app', 'python app.py')\n- path (optional): Path to store mock files (default: ./keploy)","inputSchema":{"type":"object","required":["command"],"properties":{"command":{"type":"string","description":"Command to run (e.g. 'go run main.go', 'go test', 'npm run test', 'npm start', './my-app', or any other command)."},"path":{"type":"string","description":"Path to store mock files (default: ./keploy)"}},"additionalProperties":false},"name":"keploy_mock_record","outputSchema":{"type":"object","required":["success","mockFilePath","mockCount","protocols","message"],"properties":{"configuration":{"type":["null","object"],"required":["command","path"],"properties":{"command":{"type":"string"},"path":{"type":"string"}},"additionalProperties":false},"message":{"type":"string"},"mockCount":{"type":"integer"},"mockFilePath":{"type":"string"},"protocols":{"type":"array","items":{"type":"string"}},"success":{"type":"boolean"}},"additionalProperties":false}},{"description":"Replay recorded mocks while running a command.\n\nThis tool intercepts outgoing calls and returns recorded responses, \nenabling isolated testing without external dependencies.\n\nIMPORTANT workflow:\n1. First use keploy_list_mocks to show available mocks to the user\n2. If no mockName specified, the latest mock set will be used\n3. Show configuration to user and confirm before starting\n\nParameters:\n- command (required): Any command to run with mocks (e.g., 'go test -v', 'npm test', 'go run main.go', './my-app')\n- mockName (optional): Name of the mock set to use. If not provided, uses the latest available mock.\n- fallBackOnMiss (optional): Whether to make real calls when mock not found (default: false)","inputSchema":{"type":"object","required":["command"],"properties":{"command":{"type":"string","description":"Command to run with mocks (e.g. 'go test -v', 'npm test', 'go run main.go', or any other command)."},"fallBackOnMiss":{"type":"boolean","description":"Whether to fall back to real calls when no mock matches (default: false)"},"mockName":{"type":"string","description":"Name of the mock set to replay. Use keploy_list_mocks to see available mocks. If not provided, the latest mock set will be used."}},"additionalProperties":false},"name":"keploy_mock_test","outputSchema":{"type":"object","required":["success","mocksReplayed","mocksMissed","appExitCode","message"],"properties":{"appExitCode":{"type":"integer"},"configuration":{"type":["null","object"],"required":["command","mockName","fallBackOnMiss"],"properties":{"command":{"type":"string"},"fallBackOnMiss":{"type":"boolean"},"mockName":{"type":"string"}},"additionalProperties":false},"message":{"type":"string"},"mocksMissed":{"type":"integer"},"mocksReplayed":{"type":"integer"},"success":{"type":"boolean"}},"additionalProperties":false}}]}}
{"jsonrpc":"2.0","method":"notifications/tools/list_changed","params":{}}
{"jsonrpc":"2.0","id":4,"result":{"tools":[{"description":"List all available recorded mock sets in the keploy directory.\n\nUse this tool to:\n- Discover what mocks are available before running mock test\n- Show the user available options\n- Help user choose which mock set to use for testing\n\nReturns a list of mock set names/IDs that can be used with keploy_mock_test.","inputSchema":{"type":"object","properties":{"path":{"type":"string","description":"Path to search for mock files (default: ./keploy)"}},"additionalProperties":false},"name":"keploy_list_mocks","outputSchema":{"type":"object","required":["success","mockSets","count","path","message"],"properties":{"count":{"type":"integer"},"message":{"type":"string"},"mockSets":{"type":"array","items":{"type":"string"}},"path":{"type":"string"},"success":{"type":"boolean"}},"additionalProperties":false}},{"description":"Record outgoing calls (HTTP APIs, databases, message queues, etc.) made during command execution.\n\nThis tool captures all external dependencies while running the provided command, \ncreating mock files that can be replayed during testing.\n\nIMPORTANT: Before calling this tool, confirm the following with the user:\n- The command to run (typically the command to start your application, like 'go run main.go', 'npm start', './my-app', etc.)\n- The path to store mocks (default: ./keploy)\n\nThe tool will show the configuration and ask for confirmation before starting.\n\nParameters:\n- command (required): Any command to run (e.g., 'go run main.go', 'npm start', './my-app', 'python app.py')\n- path (optional): Path to store mock files (default: ./keploy)","inputSchema":{"type":"object","required":["command"],"properties":{"command":{"type":"string","description":"Command to run (e.g. 'go run main.go', 'go test', 'npm run test', 'npm start', './my-app', or any other command)."},"path":{"type":"string","description":"Path to store mock files (default: ./keploy)"}},"additionalProperties":false},"name":"keploy_mock_record","outputSchema":{"type":"object","required":["success","mockFilePath","mockCount","protocols","message"],"properties":{"configuration":{"type":["null","object"],"required":["command","path"],"properties":{"command":{"type":"string"},"path":{"type":"string"}},"additionalProperties":false},"message":{"type":"string"},"mockCount":{"type":"integer"},"mockFilePath":{"type":"string"},"protocols":{"type":"array","items":{"type":"string"}},"success":{"type":"boolean"}},"additionalProperties":false}},{"description":"Replay recorded mocks while running a command.\n\nThis tool intercepts outgoing calls and returns recorded responses, \nenabling isolated testing without external dependencies.\n\nIMPORTANT workflow:\n1. First use keploy_list_mocks to show available mocks to the user\n2. If no mockName specified, the latest mock set will be used\n3. Show configuration to user and confirm before starting\n\nParameters:\n- command (required): Any command to run with mocks (e.g., 'go test -v', 'npm test', 'go run main.go', './my-app')\n- mockName (optional): Name of the mock set to use. If not provided, uses the latest available mock.\n- fallBackOnMiss (optional): Whether to make real calls when mock not found (default: false)","inputSchema":{"type":"object","required":["command"],"properties":{"command":{"type":"string","description":"Command to run with mocks (e.g. 'go test -v', 'npm test', 'go run main.go', or any other command)."},"fallBackOnMiss":{"type":"boolean","description":"Whether to fall back to real calls when no mock matches (default: false)"},"mockName":{"type":"string","description":"Name of the mock set to replay. Use keploy_list_mocks to see available mocks. If not provided, the latest mock set will be used."}},"additionalProperties":false},"name":"keploy_mock_test","outputSchema":{"type":"object","required":["success","mocksReplayed","mocksMissed","appExitCode","message"],"properties":{"appExitCode":{"type":"integer"},"configuration":{"type":["null","object"],"required":["command","mockName","fallBackOnMiss"],"properties":{"command":{"type":"string"},"fallBackOnMiss":{"type":"boolean"},"mockName":{"type":"string"}},"additionalProperties":false},"message":{"type":"string"},"mocksMissed":{"type":"integer"},"mocksReplayed":{"type":"integer"},"success":{"type":"boolean"}},"additionalProperties":false}}]}}
{"jsonrpc":"2.0","id":5,"result":{"content":[{"type":"text","text":"{\"configuration\":{\"command\":\"python -m pytest test_app.py -v\",\"path\":\"./keploy\"},\"message\":\"Successfully recorded 205 mock(s) to 'keploy\\\\m-mysql-20260123-002521\\\\mocks.yaml'. Detected protocols: [MySQL]\",\"mockCount\":205,\"mockFilePath\":\"keploy\\\\m-mysql-20260123-002521\\\\mocks.yaml\",\"protocols\":[\"MySQL\"],\"success\":true}"}],"structuredContent":{"configuration":{"command":"python -m pytest test_app.py -v","path":"./keploy"},"message":"Successfully recorded 205 mock(s) to 'keploy\\m-mysql-20260123-002521\\mocks.yaml'. Detected protocols: [MySQL]","mockCount":205,"mockFilePath":"keploy\\m-mysql-20260123-002521\\mocks.yaml","protocols":["MySQL"],"success":true}}}
{"jsonrpc":"2.0","id":6,"result":{"content":[{"type":"text","text":"{\"count\":7,\"message\":\"Found 7 mock set(s). The latest is 'm-mysql-20260123-002521'. You can specify any of these with the mockName parameter in keploy_mock_test.\",\"mockSets\":[\"m-mysql-20260123-002521\",\"mock-1769107808\",\"mock-1769107678\",\"mock-1769107559\",\"mock-1769107470\",\"mock-1769107091\",\"mock-1769106800\"],\"path\":\"./keploy\",\"success\":true}"}],"structuredContent":{"count":7,"message":"Found 7 mock set(s). The latest is 'm-mysql-20260123-002521'. You can specify any of these with the mockName parameter in keploy_mock_test.","mockSets":["m-mysql-20260123-002521","mock-1769107808","mock-1769107678","mock-1769107559","mock-1769107470","mock-1769107091","mock-1769106800"],"path":"./keploy","success":true}}}
{"jsonrpc":"2.0","id":7,"result":{"content":[{"type":"text","text":"{\"appExitCode\":1,\"configuration\":{\"command\":\"python -m pytest test_app.py -v\",\"fallBackOnMiss\":false,\"mockName\":\"m-mysql-20260123-002521\"},\"message\":\"Test completed with issues. Replayed 82 mock(s), 123 mock(s) missed, app exited with code 1\",\"mocksMissed\":123,\"mocksReplayed\":82,\"success\":false}"}],"structuredContent":{"appExitCode":1,"configuration":{"command":"python -m pytest test_app.py -v","fallBackOnMiss":false,"mockName":"m-mysql-20260123-002521"},"message":"Test completed with issues. Replayed 82 mock(s), 123 mock(s) missed, app exited with code 1","mocksMissed":123,"mocksReplayed":82,"success":false}}}
